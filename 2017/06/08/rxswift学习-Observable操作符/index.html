<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>rxswift学习-Observable操作符 | lyyourc</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/app.css">
  <!-- <link rel='stylesheet' href='http://fonts.useso.com/css?family=Source+Code+Pro'> -->
  
</head>

<body>
  <nav class="app-nav">
  
    
      <a href="/.">home</a>
    
  
    
      <a href="/archives">archive</a>
    
  
    
      <a href="/atom.xml">rss</a>
    
  
</nav>

  <main class="post">
  <article>
  <h1 class="article-title">
    <a href="/2017/06/08/rxswift学习-Observable操作符/">rxswift学习-Observable操作符</a>
  </h1>

  <section class="article-meta">
    <p class="article-date">June 08 2017</p>
  </section>

  <section class="article-entry">
    <p>按照首字母一个个来吧，总共也就60个左右。</p>
<h3 id="amb"><a href="#amb" class="headerlink" title="amb"></a>amb</h3><p>将多个observable 传入amb，选择其中最先emit element的那个observable sequence。</p>
<p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-08%20%E4%B8%8B%E5%8D%882.43.36.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//静态方法</span></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">amb</span>&lt;S: Sequence&gt;<span class="params">(<span class="number">_</span> sequence: S)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt;</div><div class="line">        <span class="keyword">where</span> <span class="type">S</span>.<span class="type">Iterator</span>.<span class="type">Element</span> == <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt; </div><div class="line"><span class="comment">//实例方法</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">amb</span>&lt;O2: ObservableType&gt;</span></div><div class="line">        <span class="params">(<span class="number">_</span> <span class="keyword">right</span>: O2)</span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt; <span class="keyword">where</span> <span class="type">O2</span>.<span class="type">E</span> == <span class="type">E</span> </div><div class="line"><span class="comment">//-----------------</span></div><div class="line"><span class="keyword">let</span> first = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">            .of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">            .delaySubscription(<span class="number">2</span>, scheduler: <span class="type">ConcurrentDispatchQueueScheduler</span>.<span class="keyword">init</span>(qos: .<span class="keyword">default</span>))</div><div class="line"></div><div class="line"><span class="keyword">let</span> second = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">            .of(<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</div><div class="line">            .delaySubscription(<span class="number">3</span>, scheduler: <span class="type">ConcurrentDispatchQueueScheduler</span>.<span class="keyword">init</span>(qos: .<span class="keyword">default</span>))</div><div class="line"></div><div class="line"><span class="keyword">let</span> third = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">            .of(<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>)</div><div class="line">            .delaySubscription(<span class="number">1</span>, scheduler: <span class="type">ConcurrentDispatchQueueScheduler</span>.<span class="keyword">init</span>(qos: .<span class="keyword">default</span>))</div><div class="line"></div><div class="line"><span class="keyword">let</span> amb = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.amb([first,second,third])</div><div class="line">amb.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//------ third 最先 --</span></div><div class="line">next(<span class="number">7</span>)</div><div class="line">next(<span class="number">8</span>)</div><div class="line">next(<span class="number">9</span>)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h3 id="asMaybe"><a href="#asMaybe" class="headerlink" title="asMaybe"></a>asMaybe</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Maybe是一个包含0个或者1个element的sequence。如果observable超过了1个element，那么会收到.error (RxError.moreThanOneElement)</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">asMaybe</span><span class="params">()</span></span> -&gt; <span class="type">Maybe</span>&lt;<span class="type">E</span>&gt;</div><div class="line"></div><div class="line"><span class="comment">///-----------</span></div><div class="line"><span class="keyword">let</span> <span class="number">_</span> = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">            .of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)<span class="comment">//超过了1个</span></div><div class="line">            .asMaybe()</div><div class="line">            .asObservable()</div><div class="line">            .subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">                <span class="built_in">print</span>(event)</div><div class="line">        &#125;.disposed(by: bag)</div><div class="line"><span class="comment">//------结果</span></div><div class="line">error(<span class="type">Sequence</span> <span class="built_in">contains</span> more than one element.)</div></pre></td></tr></table></figure>
<h4 id="asSingle"><a href="#asSingle" class="headerlink" title="asSingle"></a>asSingle</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//只包含1个element的observable sequence，如果为0个那么.error(RxError.noElements),如果超过1个那么.error(RxError.moreThanOneElement)</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">asSingle</span><span class="params">()</span></span> -&gt; <span class="type">Single</span>&lt;<span class="type">E</span>&gt;</div><div class="line"></div><div class="line"><span class="comment">/** </span></div><div class="line">single和Maybe都是PrimitiveSequence，PrimitiveSequence是对Observable的封装，本身就是一个结构体包含一个observable。</div><div class="line">*/</div></pre></td></tr></table></figure>
<h4 id="buffer"><a href="#buffer" class="headerlink" title="buffer"></a>buffer</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-08%20%E4%B8%8B%E5%8D%884.01.43.png" alt=""></p>
<p>收集在规定时间内 或者 达到buffer最大值 的所有element，将他们作为一个整体发送。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">func</span> <span class="title">buffer</span><span class="params">(</span></span></div><div class="line">   timeSpan: RxTimeInterval, //时间段</div><div class="line">   <span class="built_in">count</span>: Int, //buffer的最大数量</div><div class="line">   scheduler: SchedulerType</div><div class="line"> )-&gt; <span class="type">Observable</span>&lt;[<span class="type">E</span>]&gt; </div><div class="line"> </div><div class="line"> <span class="comment">//---------</span></div><div class="line"><span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">.interval(<span class="number">1</span>, scheduler: <span class="type">ConcurrentDispatchQueueScheduler</span>.<span class="keyword">init</span>(qos: .<span class="keyword">default</span>))</div><div class="line">.take(<span class="number">5</span>)</div><div class="line">.buffer(timeSpan: <span class="number">2</span>, <span class="built_in">count</span>: <span class="number">4</span>, scheduler: <span class="type">MainScheduler</span>.instance)</div><div class="line">.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">                <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//---------</span></div><div class="line">next([<span class="number">0</span>])</div><div class="line">next([<span class="number">1</span>, <span class="number">2</span>])</div><div class="line">next([<span class="number">3</span>, <span class="number">4</span>])</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="catchError"><a href="#catchError" class="headerlink" title="catchError"></a>catchError</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-08%20%E4%B8%8B%E5%8D%884.24.19.png" alt=""></p>
 <figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">catchError</span><span class="params">(<span class="number">_</span> handler: @escaping <span class="params">(Swift.Error)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;)</div><div class="line"><span class="comment">//handler为&#123; _ in Observable.just(element) &#125;特殊情况</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">catchErrorJustReturn</span><span class="params">(<span class="number">_</span> element: E)</span></span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line">        </div><div class="line"><span class="comment">//--------example---</span></div><div class="line"><span class="type">Observable</span>.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">.asMaybe()<span class="comment">//最多只能有1个element，所以会报error</span></div><div class="line">.asObservable()</div><div class="line">.catchError &#123; (error) -&gt; <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; <span class="keyword">in</span><span class="comment">//捕获error，将其替换为Observable</span></div><div class="line">            <span class="keyword">return</span> <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.of(<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">&#125;.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">            <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//遍历sequence,如果遇到.error，那么接着下一个Observable emit element,如果observable completed了，那么结束遍历。</span></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">catchError</span>&lt;S: Sequence&gt;<span class="params">(<span class="number">_</span> sequence: S)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt; <span class="keyword">where</span> <span class="type">S</span>.<span class="type">Iterator</span>.<span class="type">Element</span> == <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt; </div><div class="line"><span class="comment">//---------- example ----</span></div><div class="line"><span class="keyword">let</span> first = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create(&#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line">  observer.onNext(<span class="number">1</span>)</div><div class="line">  observer.onNext(<span class="number">2</span>)</div><div class="line">  observer.onNext(<span class="number">3</span>)</div><div class="line">  observer.onError(<span class="type">RxError</span>.unknown)</div><div class="line">  <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">&#125;)</div><div class="line"></div><div class="line">  <span class="keyword">let</span> second = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create(&#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line">      observer.onNext(<span class="number">4</span>)</div><div class="line">      observer.onNext(<span class="number">5</span>)</div><div class="line">      observer.onNext(<span class="number">6</span>)</div><div class="line">      observer.onCompleted()</div><div class="line">      <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">let</span> third = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create(&#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line">      observer.onNext(<span class="number">7</span>)</div><div class="line">      observer.onNext(<span class="number">8</span>)</div><div class="line">      observer.onNext(<span class="number">9</span>)</div><div class="line">      observer.onError(<span class="type">RxError</span>.unknown)</div><div class="line">      <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">  &#125;)</div><div class="line">        </div><div class="line">      <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.catchError([first,second,third]).subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">        <span class="built_in">print</span>(event)</div><div class="line">      &#125;.disposed(by: bag)</div><div class="line">        </div><div class="line"><span class="comment">//------ 结果 --</span></div><div class="line">next(<span class="number">1</span>)</div><div class="line">next(<span class="number">2</span>)</div><div class="line">next(<span class="number">3</span>)</div><div class="line">next(<span class="number">4</span>)</div><div class="line">next(<span class="number">5</span>)</div><div class="line">next(<span class="number">6</span>)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="retry"><a href="#retry" class="headerlink" title="retry"></a>retry</h4><p>如果遇到.error，那么重复observable sequence，知道completed。这有可能产生无限序列。</p>
<p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8A%E5%8D%8811.44.36.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">retry</span><span class="params">()</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt; </div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">retry</span><span class="params">(<span class="number">_</span> maxAttemptCount: Int)</span></span></div><div class="line"><span class="comment">//-----example ---</span></div><div class="line"><span class="keyword">var</span> flag = <span class="number">1</span></div><div class="line"><span class="keyword">let</span> first = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create(&#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line">  observer.onNext(<span class="number">1</span>)</div><div class="line">  observer.onNext(<span class="number">2</span>)</div><div class="line">  observer.onNext(<span class="number">3</span>)</div><div class="line">  <span class="keyword">if</span>(flag == <span class="number">3</span>)&#123;</div><div class="line">      observer.onCompleted()</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">      flag += <span class="number">1</span></div><div class="line">      observer.onError(<span class="type">RxError</span>.unknown)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">&#125;)</div><div class="line"></div><div class="line">first.retry().subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">  <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//----- result ----</span></div><div class="line">next(<span class="number">1</span>)</div><div class="line">next(<span class="number">2</span>)</div><div class="line">next(<span class="number">3</span>)</div><div class="line">next(<span class="number">1</span>)</div><div class="line">next(<span class="number">2</span>)</div><div class="line">next(<span class="number">3</span>)</div><div class="line">next(<span class="number">1</span>)</div><div class="line">next(<span class="number">2</span>)</div><div class="line">next(<span class="number">3</span>)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="combineLatest"><a href="#combineLatest" class="headerlink" title="combineLatest"></a>combineLatest</h4><p>用指定的函数将多个observable sequence的elment合并成1个element，并emit 他。</p>
<p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8A%E5%8D%8811.46.01.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//使用指定的函数合并</span></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">combineLatest</span>&lt;O1: ObservableType, O2: ObservableType&gt;</span></div><div class="line">        <span class="params">(<span class="number">_</span> source1: O1, <span class="number">_</span> source2: O2, resultSelector: @escaping <span class="params">(O1.E, O2.E)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">E</span>)</div><div class="line"><span class="comment">//直接合并为一个元组返回</span></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">combineLatest</span>&lt;O1: ObservableType, O2: ObservableType&gt;</span></div><div class="line">        <span class="params">(<span class="number">_</span> source1: O1, <span class="number">_</span> source2: O2)</span></div><div class="line">            -&gt; <span class="type">Observable</span>&lt;(<span class="type">O1</span>.<span class="type">E</span>, <span class="type">O2</span>.<span class="type">E</span>)&gt;</div><div class="line"><span class="comment">//传入一个Observable集合          </span></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">combineLatest</span>&lt;C: Collection&gt;<span class="params">(<span class="number">_</span> collection: C, <span class="number">_</span> resultSelector: @escaping <span class="params">([C.Iterator.Element.E])</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Element</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt;</div><div class="line">        <span class="keyword">where</span> <span class="type">C</span>.<span class="type">Iterator</span>.<span class="type">Element</span>: <span class="type">ObservableType</span>            </div><div class="line"><span class="comment">//不提供resultselector，将返回最近的element数组</span></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">combineLatest</span>&lt;C: Collection&gt;<span class="params">(<span class="number">_</span> collection: C)</span></span> -&gt; <span class="type">Observable</span>&lt;[<span class="type">Element</span>]&gt;</div><div class="line">        <span class="keyword">where</span> <span class="type">C</span>.<span class="type">Iterator</span>.<span class="type">Element</span>: <span class="type">ObservableType</span>, <span class="type">C</span>.<span class="type">Iterator</span>.<span class="type">Element</span>.<span class="type">E</span> == <span class="type">Element</span></div><div class="line"><span class="comment">//最多可以合并8个</span></div><div class="line"></div><div class="line"><span class="comment">//-----example ---</span></div><div class="line"><span class="keyword">let</span> first = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;.<span class="keyword">init</span>()</div><div class="line"><span class="keyword">let</span> second = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;.<span class="keyword">init</span>()</div><div class="line"></div><div class="line"><span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.combineLatest(first, second) &#123; (o1, o2) -&gt; <span class="type">Int</span> <span class="keyword">in</span></div><div class="line">  <span class="keyword">return</span> o1 + o2</div><div class="line">&#125;.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">  <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"></div><div class="line">first.onNext(<span class="number">1</span>)</div><div class="line">second.onNext(<span class="number">5</span>)</div><div class="line">first.onNext(<span class="number">2</span>)</div><div class="line">first.onNext(<span class="number">3</span>)</div><div class="line">second.onNext(<span class="number">6</span>)</div><div class="line">first.onNext(<span class="number">4</span>)</div><div class="line">second.onNext(<span class="number">7</span>)</div><div class="line">first.onCompleted()</div><div class="line">second.onNext(<span class="number">8</span>)</div><div class="line">second.onCompleted()</div><div class="line"><span class="comment">//-------</span></div><div class="line">next(<span class="number">6</span>)</div><div class="line">next(<span class="number">7</span>)</div><div class="line">next(<span class="number">8</span>)</div><div class="line">next(<span class="number">9</span>)</div><div class="line">next(<span class="number">10</span>)</div><div class="line">next(<span class="number">11</span>)</div><div class="line">next(<span class="number">12</span>)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%881.58.12.png" alt=""></p>
<p>将多个observable串联起来, 最好不要用于hot observable。如果遇到.error，那么不会继续concat了。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">concat</span>&lt;O: ObservableConvertibleType&gt;<span class="params">(<span class="number">_</span> second: O)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt; <span class="keyword">where</span> <span class="type">O</span>.<span class="type">E</span> == <span class="type">E</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">concat</span>&lt;S: Sequence &gt;<span class="params">(<span class="number">_</span> sequence: S)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt;</div><div class="line">        <span class="keyword">where</span> <span class="type">S</span>.<span class="type">Iterator</span>.<span class="type">Element</span> == <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt;</div><div class="line">        </div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">concat</span><span class="params">(<span class="number">_</span> sources: Observable&lt;Element&gt; ...)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">concat</span>&lt;S: Collection &gt;<span class="params">(<span class="number">_</span> collection: S)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt;</div><div class="line"></div><div class="line"><span class="comment">//------example ----</span></div><div class="line"><span class="keyword">let</span> first = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create &#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line">    observer.onNext(<span class="number">1</span>)</div><div class="line">    observer.onNext(<span class="number">2</span>)</div><div class="line">    observer.onNext(<span class="number">3</span>)</div><div class="line">    observer.onCompleted()</div><div class="line">    <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> second = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create &#123; (observer) -&gt; <span class="type">Disposable</span> <span class="keyword">in</span></div><div class="line">    observer.onNext(<span class="number">4</span>)</div><div class="line">    observer.onNext(<span class="number">5</span>)</div><div class="line">    observer.onNext(<span class="number">6</span>)</div><div class="line">    observer.onCompleted()</div><div class="line">    <span class="keyword">return</span> <span class="type">Disposables</span>.create()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> concat = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.concat(first,second)</div><div class="line">concat.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//------result ----</span></div><div class="line">next(<span class="number">1</span>)</div><div class="line">next(<span class="number">2</span>)</div><div class="line">next(<span class="number">3</span>)</div><div class="line">next(<span class="number">4</span>)</div><div class="line">next(<span class="number">5</span>)</div><div class="line">next(<span class="number">6</span>)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="debounce"><a href="#debounce" class="headerlink" title="debounce"></a>debounce</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%882.19.29.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">debounce</span><span class="params">(<span class="number">_</span> dueTime: RxTimeInterval, scheduler: SchedulerType)</span></span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="ifEmpty"><a href="#ifEmpty" class="headerlink" title="ifEmpty"></a>ifEmpty</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.08.14.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> observable = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.empty().ifEmpty(<span class="keyword">default</span>: <span class="number">100</span>)</div><div class="line">observable.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//---result--</span></div><div class="line">next(<span class="number">100</span>)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="defer"><a href="#defer" class="headerlink" title="defer"></a>defer</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.11.22.png" alt=""></p>
<p>每次有人subscribe时，通过factory创建一个Observable sequence，并emit这个sequence的element。</p>
<h4 id="delay"><a href="#delay" class="headerlink" title="delay"></a>delay</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.16.57.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//如果是.error不会delay</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">delay</span><span class="params">(<span class="number">_</span> dueTime: RxTimeInterval, scheduler: SchedulerType)</span></span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="delaySubscription"><a href="#delaySubscription" class="headerlink" title="delaySubscription"></a>delaySubscription</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//delay Subscription， 也就是说如果第一个就是.error也会delay.</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">delaySubscription</span><span class="params">(<span class="number">_</span> dueTime: RxTimeInterval, scheduler: SchedulerType)</span></span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="materialize"><a href="#materialize" class="headerlink" title="materialize"></a>materialize</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.24.38.png" alt=""></p>
<hr>
<p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.24.49.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">.materialize()</div><div class="line">.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//---- result</span></div><div class="line">next(next(<span class="number">1</span>))</div><div class="line">next(next(<span class="number">2</span>))</div><div class="line">next(next(<span class="number">3</span>))</div><div class="line">next(completed)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="distinctUntilChanged"><a href="#distinctUntilChanged" class="headerlink" title="distinctUntilChanged"></a>distinctUntilChanged</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.29.52.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//去掉连续的重复的element</span></div></pre></td></tr></table></figure>
<h4 id="do"><a href="#do" class="headerlink" title="do"></a>do</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">///为每个event注册一个action，当event到达时，调用对应的event。</span></div><div class="line"><span class="comment">//和直接调用subscribe方法相比，多了onSubscribe和onSubscribed</span></div><div class="line"><span class="function"><span class="keyword">func</span> `<span class="title">do</span>`<span class="params">(onNext: <span class="params">(<span class="params">(E)</span></span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Void</span>)? = <span class="literal">nil</span>, onError: ((<span class="type">Swift</span>.<span class="type">Error</span>) <span class="keyword">throws</span> -&gt; <span class="type">Void</span>)? = <span class="literal">nil</span>, onCompleted: (() <span class="keyword">throws</span> -&gt; <span class="type">Void</span>)? = <span class="literal">nil</span>, onSubscribe: (() -&gt; ())? = <span class="literal">nil</span>, onSubscribed: (() -&gt; ())? = <span class="literal">nil</span>, onDispose: (() -&gt; ())? = <span class="literal">nil</span>)</div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="elementAt"><a href="#elementAt" class="headerlink" title="elementAt"></a>elementAt</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.41.01.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//只发送第n个element。</span></div></pre></td></tr></table></figure>
<h4 id="ignoreElements"><a href="#ignoreElements" class="headerlink" title="ignoreElements"></a>ignoreElements</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.43.17.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//忽略所有的"element"，.error和.completed不会忽略</span></div></pre></td></tr></table></figure>
<h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//过滤element，只返回predicate为true的。</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">filter</span><span class="params">(<span class="number">_</span> predicate: @escaping <span class="params">(E)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Bool</span>)</div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="groupBy"><a href="#groupBy" class="headerlink" title="groupBy"></a>groupBy</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%883.48.31.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">将一个observable sequence分割成多个sequnce，并将每个sequnce作为一个element emit出去。</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">groupBy</span>&lt;K: Hashable&gt;<span class="params">(keySelector: @escaping <span class="params">(E)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">K</span>)</div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">GroupedObservable</span>&lt;<span class="type">K</span>,<span class="type">E</span>&gt;&gt;</div><div class="line"><span class="comment">//用keySelector来为每个element生成一个唯一标识，将具有相同唯一标识的element分为一组。最后将每组作为一个element emit出去。        </span></div><div class="line"></div><div class="line"><span class="comment">//------example----</span></div><div class="line"><span class="keyword">let</span> ob = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>)</div><div class="line"><span class="keyword">let</span> groupe = ob.groupBy &#123; (value) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">return</span> value % <span class="number">2</span> == <span class="number">0</span> <span class="comment">//按照奇偶分组</span></div><div class="line">&#125;</div><div class="line">groupe.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> observable = event.element &#123;</div><div class="line">        <span class="keyword">let</span> key = observable.key</div><div class="line">        observable.subscribe(&#123; (event) <span class="keyword">in</span></div><div class="line">            <span class="built_in">print</span>(<span class="string">"key <span class="subst">\(key)</span> value:<span class="subst">\(event)</span>"</span>)</div><div class="line">        &#125;).disposed(by: <span class="keyword">self</span>.bag)</div><div class="line">    &#125;</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//------result---</span></div><div class="line">key <span class="literal">false</span> value:next(<span class="number">1</span>)</div><div class="line">key <span class="literal">true</span> value:next(<span class="number">2</span>)</div><div class="line">key <span class="literal">false</span> value:next(<span class="number">3</span>)</div><div class="line">key <span class="literal">true</span> value:next(<span class="number">4</span>)</div><div class="line">key <span class="literal">false</span> value:next(<span class="number">5</span>)</div><div class="line">key <span class="literal">true</span> value:next(<span class="number">6</span>)</div><div class="line">key <span class="literal">false</span> value:next(<span class="number">7</span>)</div><div class="line">key <span class="literal">true</span> value:next(<span class="number">8</span>)</div><div class="line">key <span class="literal">false</span> value:next(<span class="number">9</span>)</div><div class="line">key <span class="literal">false</span> value:completed</div><div class="line">key <span class="literal">true</span> value:completed</div></pre></td></tr></table></figure>
<h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%884.06.44.png" alt=""></p>
<p>对每个element执行map函数，得到一个新的element。</p>
<h2 id="Merge相关"><a href="#Merge相关" class="headerlink" title="Merge相关"></a>Merge相关</h2><h4 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">merge</span><span class="params">(<span class="number">_</span> sources: Observable&lt;E&gt;...)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">merge</span><span class="params">(<span class="number">_</span> sources: [Observable&lt;E&gt;])</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">merge</span>&lt;C: Collection&gt;<span class="params">(<span class="number">_</span> sources: C)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt; <span class="keyword">where</span> <span class="type">C</span>.<span class="type">Iterator</span>.<span class="type">Element</span> == <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-09%20%E4%B8%8B%E5%8D%884.11.10.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//通过selector将一个element转换为一个observable sequence。然后所有得到的observables执行merge操作，作为最终的结果。</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">flatMap</span>&lt;O: ObservableConvertibleType&gt;<span class="params">(<span class="number">_</span> selector: @escaping <span class="params">(E)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">O</span>)</div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">O</span>.<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="flatMapWithIndex"><a href="#flatMapWithIndex" class="headerlink" title="flatMapWithIndex"></a>flatMapWithIndex</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//和上面的区别在于，传入的selector带有的index参数。</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">flatMapWithIndex</span>&lt;O: ObservableConvertibleType&gt;<span class="params">(<span class="number">_</span> selector: @escaping <span class="params">(E, Int)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">O</span>)</div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">O</span>.<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="flatMapFirst"><a href="#flatMapFirst" class="headerlink" title="flatMapFirst"></a>flatMapFirst</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">并发的时候，只取当前正在处理的observable，忽略过程中其他observable。</div></pre></td></tr></table></figure>
<h4 id="multicast"><a href="#multicast" class="headerlink" title="multicast"></a>multicast</h4><p>将source observable sequence传递给某个subject，subject会将element传递给所有subscribe了的observer。初步的感觉就是：将某个observable sequence作为subject的数据源。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//注意返回的是一个ConnectableObservable, 也就是说只有当你调用了connect方法时，才会将source observable sequence的element通过subject转发给所有的observer。</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">multicast</span>&lt;S: SubjectType&gt;<span class="params">(<span class="number">_</span> subject: S)</span></span></div><div class="line">        -&gt; <span class="type">ConnectableObservable</span>&lt;<span class="type">S</span>.<span class="type">E</span>&gt; <span class="keyword">where</span> <span class="type">S</span>.<span class="type">SubjectObserverType</span>.<span class="type">E</span> == <span class="type">E</span></div><div class="line"><span class="comment">//--------- example ----</span></div><div class="line"><span class="keyword">let</span> subject = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;.<span class="keyword">init</span>()</div><div class="line"></div><div class="line"><span class="keyword">let</span> publish = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">.multicast(subject)</div><div class="line"></div><div class="line">publish.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(<span class="string">"first observer <span class="subst">\(event)</span>"</span>)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"></div><div class="line">publish.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(<span class="string">"second observer <span class="subst">\(event)</span>"</span>)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"></div><div class="line">publish.connect().disposed(by: bag)</div><div class="line"><span class="comment">//----- result ---</span></div><div class="line">first observer next(<span class="number">1</span>)</div><div class="line">second observer next(<span class="number">1</span>)</div><div class="line">first observer next(<span class="number">2</span>)</div><div class="line">second observer next(<span class="number">2</span>)</div><div class="line">first observer next(<span class="number">3</span>)</div><div class="line">second observer next(<span class="number">3</span>)</div><div class="line">first observer next(<span class="number">4</span>)</div><div class="line">second observer next(<span class="number">4</span>)</div><div class="line">first observer next(<span class="number">5</span>)</div><div class="line">second observer next(<span class="number">5</span>)</div><div class="line">first observer completed</div><div class="line">second observer completed</div></pre></td></tr></table></figure>
<h4 id="publish"><a href="#publish" class="headerlink" title="publish"></a>publish</h4><p>当subject为publishsubject时的特殊multicast。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">publish</span><span class="params">()</span></span> -&gt; <span class="type">ConnectableObservable</span>&lt;<span class="type">E</span>&gt; &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.multicast(<span class="type">PublishSubject</span>())</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="replay"><a href="#replay" class="headerlink" title="replay"></a>replay</h4><p>当subject为ReplaySubject时的特殊multicast</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">replay</span><span class="params">(<span class="number">_</span> bufferSize: Int)</span></span></div><div class="line">      -&gt; <span class="type">ConnectableObservable</span>&lt;<span class="type">E</span>&gt; &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">self</span>.multicast(<span class="type">ReplaySubject</span>.create(bufferSize: bufferSize))</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="replayAll"><a href="#replayAll" class="headerlink" title="replayAll"></a>replayAll</h4><p>当subject为ReplaySubject时的特殊multicast。ReplaySubject的buff为all。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">replayAll</span><span class="params">()</span></span></div><div class="line">        -&gt; <span class="type">ConnectableObservable</span>&lt;<span class="type">E</span>&gt; &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.multicast(<span class="type">ReplaySubject</span>.createUnbounded())</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="refCount"><a href="#refCount" class="headerlink" title="refCount"></a>refCount</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%883.19.56.png" alt=""></p>
<p>让一个connectable observable表现的像一个普通的observable。我们知道一个connectable observable的主要特点就是只有在调用了connect方法后才会emit element 。而refcount操作符，自动化了connect和disconnect。当第一个observer subscribe了，他会自动connect 对应的connectable observable。他会记录有多少observer subscribe了他，当最后一个observer dispose之后会disconnect。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//注意修饰的是ConnectableObservableType</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">refCount</span><span class="params">()</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"><span class="comment">//----- example ---</span></div><div class="line"><span class="keyword">let</span> subject = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;.<span class="keyword">init</span>()</div><div class="line"><span class="keyword">let</span> publish =</div><div class="line">    <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">    .interval(<span class="number">1</span>, scheduler: <span class="type">ConcurrentDispatchQueueScheduler</span>.<span class="keyword">init</span>(qos: .<span class="keyword">default</span>))</div><div class="line">    .take(<span class="number">5</span>)</div><div class="line">    .multicast(subject)</div><div class="line">    .refCount()</div><div class="line">publish.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(<span class="string">"first observer <span class="subst">\(event)</span>"</span>)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"></div><div class="line">publish.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(<span class="string">"second observer <span class="subst">\(event)</span>"</span>)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">///不用调用connect也能够收到element </span></div><div class="line"></div><div class="line"><span class="comment">//----- result ---</span></div><div class="line">first observer next(<span class="number">0</span>)</div><div class="line">second observer next(<span class="number">0</span>)</div><div class="line">first observer next(<span class="number">1</span>)</div><div class="line">second observer next(<span class="number">1</span>)</div><div class="line">first observer next(<span class="number">2</span>)</div><div class="line">second observer next(<span class="number">2</span>)</div><div class="line">first observer next(<span class="number">3</span>)</div><div class="line">second observer next(<span class="number">3</span>)</div><div class="line">first observer next(<span class="number">4</span>)</div><div class="line">second observer next(<span class="number">4</span>)</div><div class="line">first observer completed</div><div class="line">second observer completed</div></pre></td></tr></table></figure>
<h4 id="never"><a href="#never" class="headerlink" title="never"></a>never</h4><p>返回一个不会退出的observable sequnce。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">never</span><span class="params">()</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="observeOn"><a href="#observeOn" class="headerlink" title="observeOn"></a>observeOn</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%883.31.10.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//在学习scheduler时已经说过了他的作用：封装source sequnce，让他的observer callback在指定的scheduler上执行。</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">observeOn</span><span class="params">(<span class="number">_</span> scheduler: ImmediateSchedulerType)</span></span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="optional"><a href="#optional" class="headerlink" title="optional"></a>optional</h4><p>将某个option值转化为一个observable sequnce。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">from</span><span class="params">(<span class="keyword">optional</span>: E?)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">from</span><span class="params">(<span class="keyword">optional</span>: E?, </span></span></div><div class="line">scheduler: ImmediateSchedulerType //将element发送到那个scheduler上。</div><div class="line">) -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="range"><a href="#range" class="headerlink" title="range"></a>range</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%883.30.05.png" alt=""></p>
<p>通过起始值和elment数目生成某个范围内的值，并将其封装为一个observable sequence。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">range</span><span class="params">(start: E, <span class="built_in">count</span>: E, scheduler: ImmediateSchedulerType = CurrentThreadScheduler.instance)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%883.32.10.png" alt=""></p>
<p>提供一个初始值和 函数，对所有元素操作后的结果作为一个 element。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">reduce</span>&lt;A, R&gt;<span class="params">(</span></span></div><div class="line">	<span class="number">_</span> seed: A, </div><div class="line">	accumulator: @escaping <span class="params">(A, E)</span> <span class="keyword">throws</span> -&gt; <span class="type">A</span>,</div><div class="line">	mapResult: @escaping (<span class="type">A</span>) <span class="keyword">throws</span> -&gt; <span class="type">R</span></div><div class="line">) -&gt; <span class="type">Observable</span>&lt;<span class="type">R</span>&gt; </div><div class="line"><span class="comment">//--- example --</span></div><div class="line"><span class="comment">//计算1到10的和 将结果作为一个observable&lt;string&gt;返回</span></div><div class="line"><span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">.range(start: <span class="number">1</span>, <span class="built_in">count</span>: <span class="number">10</span>)</div><div class="line">.<span class="built_in">reduce</span>(<span class="number">0</span>, accumulator: +) &#123; (finalValue) -&gt;<span class="type">String</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">return</span> <span class="string">"<span class="subst">\(finalValue)</span>"</span></div><div class="line">&#125;.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">	<span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//----- result --</span></div><div class="line">next(<span class="number">55</span>)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="repeat"><a href="#repeat" class="headerlink" title="repeat"></a>repeat</h4><p>无限重复生成某个element</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">repeatElement</span><span class="params">(</span></span></div><div class="line">  <span class="number">_</span> element: E, </div><div class="line">  scheduler: ImmediateSchedulerType = CurrentThreadScheduler.instance</div><div class="line">) -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="sample"><a href="#sample" class="headerlink" title="sample"></a>sample</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%883.54.07.png" alt=""></p>
<p>将一个observable sequence作为一个采样序列，每当采样序列来了一个element，就会将source sequence的最近一个element添加到result sequence中，如果最近elemen是同一个，那么不会重复添加。</p>
<h4 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%883.57.42.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">将accumulator得到的结果作为sequence。</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">scan</span>&lt;A&gt;<span class="params">(</span></span></div><div class="line"> <span class="number">_</span> seed: A, </div><div class="line">accumulator: @escaping <span class="params">(A, E)</span> <span class="keyword">throws</span> -&gt; <span class="type">A</span></div><div class="line">)-&gt; <span class="type">Observable</span>&lt;<span class="type">A</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="of"><a href="#of" class="headerlink" title="of"></a>of</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">of</span><span class="params">(<span class="number">_</span> elements: E ..., scheduler: ImmediateSchedulerType = CurrentThreadScheduler.instance)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="from"><a href="#from" class="headerlink" title="from"></a>from</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">from</span><span class="params">(<span class="number">_</span> array: [E], scheduler: ImmediateSchedulerType = CurrentThreadScheduler.instance)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">from</span>&lt;S: Sequence&gt;<span class="params">(<span class="number">_</span> sequence: S, scheduler: ImmediateSchedulerType = CurrentThreadScheduler.instance)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt; <span class="keyword">where</span> <span class="type">S</span>.<span class="type">Iterator</span>.<span class="type">Element</span> == <span class="type">E</span></div></pre></td></tr></table></figure>
<h4 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//忽略前n个element</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">skip</span><span class="params">(<span class="number">_</span> <span class="built_in">count</span>: Int)</span></span>  -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"><span class="comment">//-----</span></div><div class="line"> <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;</div><div class="line">.range(start: <span class="number">1</span>, <span class="built_in">count</span>: <span class="number">10</span>)</div><div class="line">.skip(<span class="number">3</span>)</div><div class="line">.subscribe &#123; (event) <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(event)</div><div class="line">&#125;.disposed(by: bag)</div><div class="line"><span class="comment">//----</span></div><div class="line">next(<span class="number">4</span>)</div><div class="line">next(<span class="number">5</span>)</div><div class="line">next(<span class="number">6</span>)</div><div class="line">next(<span class="number">7</span>)</div><div class="line">next(<span class="number">8</span>)</div><div class="line">next(<span class="number">9</span>)</div><div class="line">next(<span class="number">10</span>)</div><div class="line">completed</div></pre></td></tr></table></figure>
<h4 id="skipUntil"><a href="#skipUntil" class="headerlink" title="skipUntil"></a>skipUntil</h4><p>一直跳过，直到某个observable 开始emit element了。</p>
<p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%884.12.46.png" alt=""></p>
<h4 id="skipWhile"><a href="#skipWhile" class="headerlink" title="skipWhile"></a>skipWhile</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%884.14.20.png" alt=""></p>
<h4 id="startWith"><a href="#startWith" class="headerlink" title="startWith"></a>startWith</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%884.16.17.png" alt=""></p>
<h4 id="subscribeOn"><a href="#subscribeOn" class="headerlink" title="subscribeOn"></a>subscribeOn</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%884.18.14.png" alt=""></p>
<h4 id="flatMapLatest"><a href="#flatMapLatest" class="headerlink" title="flatMapLatest"></a>flatMapLatest</h4><p>同flatMap，只是只取最近的elemnt。</p>
<h4 id="switchLatest"><a href="#switchLatest" class="headerlink" title="switchLatest"></a>switchLatest</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%884.24.41.png" alt=""></p>
<h4 id="take相关"><a href="#take相关" class="headerlink" title="take相关"></a>take相关</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//只取前n个</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">take</span><span class="params">(<span class="number">_</span> <span class="built_in">count</span>: Int)</span></span></div><div class="line"><span class="comment">//只取前duration内的element</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">take</span><span class="params">(<span class="number">_</span> duration: RxTimeInterval, scheduler: SchedulerType)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"><span class="comment">//只取最后n个</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">takeLast</span><span class="params">(<span class="number">_</span> <span class="built_in">count</span>: Int)</span></span>-&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"><span class="comment">//一直take，直到other emit了element。</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">takeUntil</span>&lt;O: ObservableType&gt;<span class="params">(<span class="number">_</span> other: O)</span></span>-&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line"><span class="comment">//当满足条件就一直take</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">takeWhile</span><span class="params">(<span class="number">_</span> predicate: @escaping <span class="params">(E)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Bool</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="throttle"><a href="#throttle" class="headerlink" title="throttle"></a>throttle</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">throttle</span><span class="params">(<span class="number">_</span> dueTime: RxTimeInterval, latest: Bool = <span class="literal">true</span>, scheduler: SchedulerType)</span></span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="timeout"><a href="#timeout" class="headerlink" title="timeout"></a>timeout</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%884.56.41.png" alt=""></p>
<p>规定时间内没有收到element会产生一个error。</p>
<h4 id="interval"><a href="#interval" class="headerlink" title="interval"></a>interval</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%884.58.45.png" alt=""></p>
<p>每隔一段时间产生一个element</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">interval</span><span class="params">(<span class="number">_</span> period: RxTimeInterval, scheduler: SchedulerType)</span></span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="timer"><a href="#timer" class="headerlink" title="timer"></a>timer</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%885.01.20.png" alt=""></p>
<h4 id="toArray"><a href="#toArray" class="headerlink" title="toArray"></a>toArray</h4><p>将所有element弄成一个数组，作为一个element 。</p>
<p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%885.03.25.png" alt=""></p>
<h4 id="using"><a href="#using" class="headerlink" title="using"></a>using</h4><p>创建一个disposable的resource，只在observable sequence的生命周期内存在，当sequnce dispose时，resouce也dispose。</p>
<p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%885.05.41.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">using</span>&lt;Resource: Disposable&gt;<span class="params">(<span class="number">_</span> resourceFactory: @escaping <span class="params">()</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Resource</span>, observableFactory: @escaping (<span class="type">Resource</span>) <span class="keyword">throws</span> -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;) -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="window"><a href="#window" class="headerlink" title="window"></a>window</h4><p>和buffer类似，不过不是讲多个element弄成一个数组 emit，而是将多个element弄成一个observable sequnce再 emit。</p>
<p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%885.09.11.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">window</span><span class="params">(timeSpan: RxTimeInterval, <span class="built_in">count</span>: Int, scheduler: SchedulerType)</span></span></div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">Observable</span>&lt;<span class="type">E</span>&gt;&gt;</div></pre></td></tr></table></figure>
<h4 id="withLatestFrom"><a href="#withLatestFrom" class="headerlink" title="withLatestFrom"></a>withLatestFrom</h4><p>同combineLatest。只是调用的方式不一样。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">withLatestFrom</span>&lt;SecondO: ObservableConvertibleType, ResultType&gt;<span class="params">(<span class="number">_</span> second: SecondO, resultSelector: @escaping <span class="params">(E, SecondO.E)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">ResultType</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">ResultType</span>&gt;</div></pre></td></tr></table></figure>
<h4 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h4><p><img src="http://xingou.oss-cn-shanghai.aliyuncs.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-06-12%20%E4%B8%8B%E5%8D%885.13.13.png" alt=""></p>
<p>和comebineLatest类似，不过不是latest，而是严格的1对1.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">zip</span>&lt;O1: ObservableType, O2: ObservableType&gt;</span></div><div class="line">        <span class="params">(<span class="number">_</span> source1: O1, <span class="number">_</span> source2: O2, resultSelector: @escaping <span class="params">(O1.E, O2.E)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">E</span>)</div><div class="line">        -&gt; <span class="type">Observable</span>&lt;<span class="type">E</span>&gt;</div><div class="line">        </div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">zip</span>&lt;C: Collection&gt;<span class="params">(<span class="number">_</span> collection: C, <span class="number">_</span> resultSelector: @escaping <span class="params">([C.Iterator.Element.E])</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Element</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">Element</span>&gt;</div><div class="line">        <span class="keyword">where</span> <span class="type">C</span>.<span class="type">Iterator</span>.<span class="type">Element</span>: <span class="type">ObservableType</span></div><div class="line">        </div><div class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">zip</span>&lt;C: Collection&gt;<span class="params">(<span class="number">_</span> collection: C)</span></span> -&gt; <span class="type">Observable</span>&lt;[<span class="type">Element</span>]&gt;</div><div class="line">        <span class="keyword">where</span> <span class="type">C</span>.<span class="type">Iterator</span>.<span class="type">Element</span>: <span class="type">ObservableType</span>, <span class="type">C</span>.<span class="type">Iterator</span>.<span class="type">Element</span>.<span class="type">E</span> == <span class="type">Element</span></div></pre></td></tr></table></figure>

  </section>
</article>

  <div class="sharing grid">
  <section class="profile grid-item grid">
    <img class="avatar" src="http://7xrcp8.com1.z0.glb.clouddn.com/avatar.png" alt="avatar" />
    <div class="grid-item">
      <p class="title"> lyyourc </p>
      <p class="subtitle"> You Are The JavaScript In My HTML </p>
    <div>
  </section>

  <section class="share-btns">
    <!-- <p> share it if you like it~ </p> -->
    <a
  class="twitter-share-button"
  data-size="large"
  data-via="DrakeLeung"
  href="https://twitter.com/intent/tweet?text=按照首字母一个个来吧，总共也就60个左右"
>
  Tweet
</a>

<script>
  window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  js.async = true;
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
</script>

  </section>
</div>


  
    
<section class="article-comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

<script>
  var disqus_shortname = 'drakeleung';
  
  var disqus_url = 'http://yoursite.com/2017/06/08/rxswift学习-Observable操作符/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


  
</main>

</body>
</html>
